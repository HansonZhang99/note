<html>
<head>
  <title>阿里云物联网平台C-SDK学习</title>
  <basefont face="Verdana" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/604762 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: Verdana;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="532"/>
<h1>阿里云物联网平台C-SDK学习</h1>

<div>
<span><div><font style="font-size: 14pt;"><span style="background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 14pt; background-color: rgb(255, 255, 255); font-family: PingFangSC, &quot;helvetica neue&quot;, &quot;hiragino sans gb&quot;, arial, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold; line-height: 24px;">什么是物联网平台？</span></span></span></font></div><div><font style="font-size: 12pt;"><span style="background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; font-size: 12pt; background-color: rgb(255, 255, 255); font-family: PingFangSC, &quot;helvetica neue&quot;, &quot;hiragino sans gb&quot;, arial, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 24px;">        <span style="font-size: 12pt; background-color: rgb(255, 255, 255); font-family: PingFangSC, &quot;helvetica neue&quot;, &quot;hiragino sans gb&quot;, arial, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 24px; font-weight: bold;">阿里云物联网平台为设备提供安全可靠的连接通信能力，向下连接海量设备，支撑设备数据采集上云；向上提供云端API，指令数据通过API调用下发至设备端，实现远程控制。</span></span></span></font></div><div><span style="background-color: rgb(255, 255, 255);"><span style="box-sizing: border-box; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="background-color: rgb(255, 255, 255); font-size: 12pt; font-family: PingFangSC, &quot;helvetica neue&quot;, &quot;hiragino sans gb&quot;, arial, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 24px;">物联网平台也提供了其他增值能力，如设备管理、规则引擎、数据分析、边缘计算等，为各类IoT场景和行业开发者赋能。</span></span></span></div><div><br/></div><div><span style="font-size: 12pt; font-family: PingFangSC;">可大致用这个图来概括</span></div><div><span style="font-size: 12pt; font-family: PingFangSC;"><img src="阿里云物联网平台C-SDK学习_files/Image.png" type="image/png" data-filename="Image.png"/></span></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><font style="font-size: 14pt;"><span style="font-size: 14pt; font-family: PingFangSC, &quot;helvetica neue&quot;, &quot;hiragino sans gb&quot;, arial, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: bold;">topic：</span></font></span></div><div><span style="letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-size: 12pt; font-family: PingFangSC, &quot;helvetica neue&quot;, &quot;hiragino sans gb&quot;, arial, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">        物联网平台中，服务端和设备端通过 Topic 来实现消息通信。Topic是针对设备的概念，Topic类是针对产品的概念。产品的Topic类会自动映射到产品下的所有设备中，生成用于消息通信的具体设备Topic。</span></span></div><div><br/></div><div><span style="font-size: 12pt; font-family: PingFangSC;">在物联网平台创建一个产品，并在其下创建一个对应的设备，此设备下的topic列表会出现多个topic。如下，我创建了有一产品，其下有一个设备DS18B20，其topic列表如下：</span></div><div><span style="font-size: 12pt; font-family: PingFangSC;"><img src="阿里云物联网平台C-SDK学习_files/Image [1].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; font-family: PingFangSC;">其中最下面三个topic用户可在产品栏中设置其状态（订阅，发布，订阅和发布）</span></div><div><span style="font-size: 12pt; font-family: PingFangSC;">最上面的post是用于上报设备的属性，设备操作权限为发布，但是我是用mqtt.fx和C-SDK提供的接口去订阅，是可以的。发布到post的topic主题，会在设备的运行状态中显示，如下：</span></div><div><span style="font-size: 12pt; font-family: PingFangSC;"><img src="阿里云物联网平台C-SDK学习_files/Image [2].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; font-family: PingFangSC;">同测试，发现1，2，3，4，5都可以被发布和订阅，而只有1是会被记录在设备的运行状态中的，而且其数据格式必须为JSON格式，而2，5可以订阅和发布，数据格式为任意，3，4，可被订阅和发布，使用mqtt.fx测试订阅并在一次发布后就会断开连接，而使用C-SDK订阅和发布均不会断开连接。这是本人的测试结果，使用的是mqtt.fx和C-SDK测试。</span></div><div><span style="font-size: 12pt; font-family: PingFangSC;"><img src="阿里云物联网平台C-SDK学习_files/Image [3].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; font-family: PingFangSC;"><img src="阿里云物联网平台C-SDK学习_files/Image [4].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-family: PingFangSC;">在之前，一直纠结一点，设备将温度发布到物联网平台，此数据要被其他用户获取，该怎么做，想到设备是可以订阅自己发布的topic的，便想到使用设备三元组再连接到物联网平台获取温度，但是这样会使设备端与平台断开连接。</span></div><div><span style="font-size: 12pt; font-family: PingFangSC;"><img src="阿里云物联网平台C-SDK学习_files/Image [5].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; font-family: PingFangSC;">此账号为设备的账号，其用户名是唯一的，只能一处登录。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-family: PingFangSC;">那如何实现用户获取设备发布到平台的数据呢，或者说，实现这张图：</span></div><div><span style="font-size: 12pt; font-family: PingFangSC;"><img src="阿里云物联网平台C-SDK学习_files/Image [6].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; font-family: PingFangSC;">查阅阿里云有关物联网的文档后，发现C-SDK实现平台到服务器（或说到用户）的。</span></div><div><span style="font-size: 12pt; font-family: PingFangSC;"><img src="阿里云物联网平台C-SDK学习_files/Image [7].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; font-family: PingFangSC;"><img src="阿里云物联网平台C-SDK学习_files/Image [8].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; font-family: PingFangSC;"><img src="阿里云物联网平台C-SDK学习_files/Image [9].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt; font-family: PingFangSC;"><img src="阿里云物联网平台C-SDK学习_files/Image [10].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-size: 12pt; font-family: PingFangSC;">所以在平台和用户之间，是不能用C-SDK开发的，因此，使用C-SDK只能做到设备向平台发送数据。</span></div><div><span style="font-size: 12pt;"><br/></span></div><div><span style="font-size: 12pt;">参考：</span> <span style="font-size: 12pt;"><a href="https://help.aliyun.com/document_detail/87254.html?spm=a2c4g.11186623.6.557.62993d66eJIhD8">https://help.aliyun.com/document_detail/87254.html?spm=a2c4g.11186623.6.557.62993d66eJIhD8</a></span></div><div><span style="font-size: 12pt;"><br/></span></div></span>
</div></body></html> 