<html>
<head>
  <title>磁盘分区格式化与挂载</title>
  <basefont face="Verdana" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/604762 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: Verdana;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1205"/>
<h1>磁盘分区格式化与挂载</h1>

<div>
<span><div><span style="font-size: 14pt; font-weight: bold;">使硬盘变得可以使用</span></div><div>1.对磁盘进行分区，以新建可用的分区</div><div>2.对该分区进行格式化，以创建系统可用的文件系统</div><div>3.可对刚建好的文件系统进行检验</div><div>4.将其挂载在挂载点上即可开始使用</div><div><br/></div><div><font color="#FF0000" style="font-size: 14pt;"><br/></font></div><div><span style="font-size: 14pt; font-weight: bold;">查看磁盘分区--fdisk命令</span></div><div><span style="font-size: 10pt;">查看系统挂载在根目录下的分区：</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@zhanghang-virtual-machine:~# <font color="#FF0000">fdisk /dev/sda</font></div><div><br/></div><div><br/></div><div>Command (m for help): p</div><div><br/></div><div><br/></div><div>Disk /dev/sda: 54.8 GB, 54760833024 bytes</div><div>255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</div><div>Units = sectors of 1 * 512 = 512 bytes</div><div>Sector size (logical/physical): 512 bytes / 512 bytes</div><div>I/O size (minimum/optimal): 512 bytes / 512 bytes</div><div>Disk identifier: 0x0005c381</div><div><br/></div><div><br/></div><div>   Device Boot      Start         End      Blocks   Id  System</div><div>/dev/sda1   *        2048    79693823    39845888   83  Linux</div><div>/dev/sda2        79695870    83884031     2094081    5  Extended</div><div>/dev/sda5        79695872    83884031     2094080   82  Linux swap / Solaris</div></div><div><br/></div><div>磁盘总容量为40.8GB，4960个柱面，每个柱面通过255个磁头管理读写，每个磁头管理63个扇区，每个扇区大小为512KB</div><div>fdisk -l显示系统所有分区。</div><div>Device为设备名，Boot为*代表该分区是系统开机引导模块分区</div><div>start end分区开始与结束的扇区编号，可以计算出该磁盘还有剩余空间。/dev/sda5使用的是来自/dev/sda2的扩展分区</div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">删除分区</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@zhanghang-virtual-machine:~# fdisk /dev/sda</div><div><br/></div><div><br/></div><div>Command (m for help): p</div><div><br/></div><div><br/></div><div>Disk /dev/sda: 54.8 GB, 54760833024 bytes</div><div>255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</div><div>Units = sectors of 1 * 512 = 512 bytes</div><div>Sector size (logical/physical): 512 bytes / 512 bytes</div><div>I/O size (minimum/optimal): 512 bytes / 512 bytes</div><div>Disk identifier: 0x0005c381</div><div><br/></div><div><br/></div><div>   Device Boot      Start         End      Blocks   Id  System</div><div>/dev/sda1   *        2048    79693823    39845888   83  Linux</div><div>/dev/sda2        79695870    83884031     2094081    5  Extended</div><div>/dev/sda5        79695872    83884031     2094080   82  Linux swap / Solaris</div><div><br/></div><div><br/></div><div>Command (m for help): <font color="#FF0000">d</font></div><div>Partition number (1-5): 5</div><div><br/></div><div><br/></div><div>Command (m for help): p</div><div><br/></div><div><br/></div><div>Disk /dev/sda: 54.8 GB, 54760833024 bytes</div><div>255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</div><div>Units = sectors of 1 * 512 = 512 bytes</div><div>Sector size (logical/physical): 512 bytes / 512 bytes</div><div>I/O size (minimum/optimal): 512 bytes / 512 bytes</div><div>Disk identifier: 0x0005c381</div><div><br/></div><div><br/></div><div>   Device Boot      Start         End      Blocks   Id  System</div><div>/dev/sda1   *        2048    79693823    39845888   83  Linux</div><div>/dev/sda2        79695870    83884031     2094081    5  Extended</div><div><br/></div><div><br/></div><div>Command (m for help): q</div></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">新增分区（测试）</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@zhanghang-virtual-machine:~# fdisk /dev/sda</div><div><br/></div><div><br/></div><div>Command (m for help): p</div><div><br/></div><div><br/></div><div>Disk /dev/sda: 54.8 GB, 54760833024 bytes</div><div>255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</div><div>Units = sectors of 1 * 512 = 512 bytes</div><div>Sector size (logical/physical): 512 bytes / 512 bytes</div><div>I/O size (minimum/optimal): 512 bytes / 512 bytes</div><div>Disk identifier: 0x0005c381</div><div><br/></div><div><br/></div><div>   Device Boot      Start         End      Blocks   Id  System</div><div>/dev/sda1   *        2048    79693823    39845888   83  Linux</div><div>/dev/sda2        79695870    83884031     2094081    5  Extended</div><div>/dev/sda5        79695872    83884031     2094080   82  Linux swap / Solaris</div><div><br/></div><div><br/></div><div>Command (m for help): d</div><div>Partition number (1-5): 5</div><div><br/></div><div><br/></div><div>Command (m for help): d</div><div>Partition number (1-5): 4</div><div>Warning: partition 4 has empty type</div><div><br/></div><div><br/></div><div>Command (m for help): p</div><div><br/></div><div><br/></div><div>Disk /dev/sda: 54.8 GB, 54760833024 bytes</div><div>255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</div><div>Units = sectors of 1 * 512 = 512 bytes</div><div>Sector size (logical/physical): 512 bytes / 512 bytes</div><div>I/O size (minimum/optimal): 512 bytes / 512 bytes</div><div>Disk identifier: 0x0005c381</div><div><br/></div><div><br/></div><div>   Device Boot      Start         End      Blocks   Id  System</div><div>/dev/sda1   *        2048    79693823    39845888   83  Linux</div><div>/dev/sda2        79695870    83884031     2094081    5  Extended</div><div><br/></div><div><br/></div><div>Command (m for help): d</div><div>Partition number (1-5): 2</div><div><br/></div><div><br/></div><div>Command (m for help): p</div><div><br/></div><div><br/></div><div>Disk /dev/sda: 54.8 GB, 54760833024 bytes</div><div>255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</div><div>Units = sectors of 1 * 512 = 512 bytes</div><div>Sector size (logical/physical): 512 bytes / 512 bytes</div><div>I/O size (minimum/optimal): 512 bytes / 512 bytes</div><div>Disk identifier: 0x0005c381</div><div><br/></div><div><br/></div><div>   Device Boot      Start         End      Blocks   Id  System</div><div>/dev/sda1   *        2048    79693823    39845888   83  Linux</div><div><br/></div><div><br/></div><div>Command (m for help): n</div><div>Partition type:</div><div>   p   primary (1 primary, 0 extended, 3 free)</div><div>   e   extended</div><div>Select (default p): p</div><div>Partition number (1-4, default 2): 2</div><div>First sector (79693824-106954751, default 79693824): +256M</div><div>Value out of range.</div><div>First sector (79693824-106954751, default 79693824):</div><div>Using default value 79693824</div><div>Last sector, +sectors or +size{K,M,G} (79693824-106954751, default 106954751): +512M</div><div><br/></div><div><br/></div><div>Command (m for help): p</div><div><br/></div><div><br/></div><div>Disk /dev/sda: 54.8 GB, 54760833024 bytes</div><div>255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</div><div>Units = sectors of 1 * 512 = 512 bytes</div><div>Sector size (logical/physical): 512 bytes / 512 bytes</div><div>I/O size (minimum/optimal): 512 bytes / 512 bytes</div><div>Disk identifier: 0x0005c381</div><div><br/></div><div><br/></div><div>   Device Boot      Start         End      Blocks   Id  System</div><div>/dev/sda1   *        2048    79693823    39845888   83  Linux</div><div>/dev/sda2        79693824    80742399      524288   83  Linux</div><div><br/></div><div><br/></div><div>Command (m for help): n</div><div>Partition type:</div><div>   p   primary (2 primary, 0 extended, 2 free)</div><div>   e   extended</div><div>Select (default p): e</div><div>Partition number (1-4, default 3): 3</div><div>First sector (80742400-106954751, default 80742400):</div><div>Using default value 80742400</div><div>Last sector, +sectors or +size{K,M,G} (80742400-106954751, default 106954751):</div><div>Using default value 106954751</div><div><br/></div><div><br/></div><div>Command (m for help): p</div><div><br/></div><div><br/></div><div>Disk /dev/sda: 54.8 GB, 54760833024 bytes</div><div>255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</div><div>Units = sectors of 1 * 512 = 512 bytes</div><div>Sector size (logical/physical): 512 bytes / 512 bytes</div><div>I/O size (minimum/optimal): 512 bytes / 512 bytes</div><div>Disk identifier: 0x0005c381</div><div><br/></div><div><br/></div><div>   Device Boot      Start         End      Blocks   Id  System</div><div>/dev/sda1   *        2048    79693823    39845888   83  Linux</div><div>/dev/sda2        79693824    80742399      524288   83  Linux</div><div>/dev/sda3        80742400   106954751    13106176    5  Extended</div><div><br/></div><div><br/></div><div>Command (m for help): n</div><div>Partition type:</div><div>   p   primary (2 primary, 1 extended, 1 free)</div><div>   l   logical (numbered from 5)</div><div>Select (default p): p</div><div>Selected partition 4</div><div>No free sectors available</div><div><br/></div><div><br/></div><div>Command (m for help): n</div><div>Partition type:</div><div>   p   primary (2 primary, 1 extended, 1 free)</div><div>   l   logical (numbered from 5)</div><div>Select (default p): l</div><div>Adding logical partition 5</div><div>First sector (80744448-106954751, default 80744448):</div><div>Using default value 80744448</div><div>Last sector, +sectors or +size{K,M,G} (80744448-106954751, default 106954751): +512M</div><div><br/></div><div><br/></div><div>Command (m for help): p</div><div><br/></div><div><br/></div><div>Disk /dev/sda: 54.8 GB, 54760833024 bytes</div><div>255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</div><div>Units = sectors of 1 * 512 = 512 bytes</div><div>Sector size (logical/physical): 512 bytes / 512 bytes</div><div>I/O size (minimum/optimal): 512 bytes / 512 bytes</div><div>Disk identifier: 0x0005c381</div><div><br/></div><div><br/></div><div>   Device Boot      Start         End      Blocks   Id  System</div><div>/dev/sda1   *        2048    79693823    39845888   83  Linux</div><div>/dev/sda2        79693824    80742399      524288   83  Linux</div><div>/dev/sda3        80742400   106954751    13106176    5  Extended</div><div>/dev/sda5        80744448    81793023      524288   83  Linux</div><div><br/></div><div><br/></div><div>Command (m for help): q</div></div><div><font style="font-size: 14pt;"><br/></font></div><div><font style="font-size: 9pt;"><span style="font-weight: bold;">新建一个分区</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# fdisk /dev/sda</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Command (m for help): p</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Disk /dev/sda: 54.8 GB, 54760833024 bytes</font></div><div><font style="font-size: 9pt;">255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</font></div><div><font style="font-size: 9pt;">Units = sectors of 1 * 512 = 512 bytes</font></div><div><font style="font-size: 9pt;">Sector size (logical/physical): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">I/O size (minimum/optimal): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">Disk identifier: 0x0005c381</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">   Device Boot      Start         End      Blocks   Id  System</font></div><div><font style="font-size: 9pt;">/dev/sda1   *        2048    79693823    39845888   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda2        79695870    83884031     2094081    5  Extended</font></div><div><font style="font-size: 9pt;">/dev/sda5        79695872    83884031     2094080   82  Linux swap / Solaris</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Command (m for help): n</font></div><div><font style="font-size: 9pt;">Partition type:</font></div><div><font style="font-size: 9pt;">   p   primary (1 primary, 1 extended, 2 free)</font></div><div><font style="font-size: 9pt;">   l   logical (numbered from 5)</font></div><div><font style="font-size: 9pt;">Select (default p): p</font></div><div><font style="font-size: 9pt;">Partition number (1-4, default 3): 3</font></div><div><font style="font-size: 9pt;">First sector (79693824-106954751, default 79693824): 83885000</font></div><div><font style="font-size: 9pt;">Last sector, +sectors or +size{K,M,G} (83885000-106954751, default 106954751): +2048M</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Command (m for help): p</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Disk /dev/sda: 54.8 GB, 54760833024 bytes</font></div><div><font style="font-size: 9pt;">255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</font></div><div><font style="font-size: 9pt;">Units = sectors of 1 * 512 = 512 bytes</font></div><div><font style="font-size: 9pt;">Sector size (logical/physical): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">I/O size (minimum/optimal): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">Disk identifier: 0x0005c381</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">   Device Boot      Start         End      Blocks   Id  System</font></div><div><font style="font-size: 9pt;">/dev/sda1   *        2048    79693823    39845888   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda2        79695870    83884031     2094081    5  Extended</font></div><div><font style="font-size: 9pt;">/dev/sda3        83885000    88079303     2097152   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda5        79695872    83884031     2094080   82  Linux swap / Solaris</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Command (m for help): w</font></div><div><font style="font-size: 9pt;">The partition table has been altered!</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Calling ioctl() to re-read partition table.</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">WARNING: Re-reading the partition table failed with error 16: Device or resource busy.</font></div><div><font style="font-size: 9pt;">The kernel still uses the old table. The new table will be used at</font></div><div><font style="font-size: 9pt;">the next reboot or after you run partprobe(8) or kpartx(8)</font></div><div><font style="font-size: 9pt;">Syncing disks.</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# partprobe</font></div><div><font style="font-size: 9pt;">Warning: Unable to open /dev/sr0 read-write (Read-only file system).  /dev/sr0 has been opened read-only.</font></div><div><font style="font-size: 9pt;">Warning: Unable to open /dev/sr0 read-write (Read-only file system).  /dev/sr0 has been opened read-only.</font></div><div><font style="font-size: 9pt;">Error: Can't have a partition outside the disk!</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# fdisk -l</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Disk /dev/sda: 54.8 GB, 54760833024 bytes</font></div><div><font style="font-size: 9pt;">255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</font></div><div><font style="font-size: 9pt;">Units = sectors of 1 * 512 = 512 bytes</font></div><div><font style="font-size: 9pt;">Sector size (logical/physical): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">I/O size (minimum/optimal): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">Disk identifier: 0x0005c381</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">   Device Boot      Start         End      Blocks   Id  System</font></div><div><font style="font-size: 9pt;">/dev/sda1   *        2048    79693823    39845888   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda2        79695870    83884031     2094081    5  Extended</font></div><div><font style="font-size: 9pt;">/dev/sda3        83885000    88079303     2097152   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda5        79695872    83884031     2094080   82  Linux swap / Solaris</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# reboot</font></div></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><span style="font-weight: bold;">磁盘格式化，检验</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@zhanghang-virtual-machine:~# mkfs</div><div>mkfs          mkfs.bfs      mkfs.cramfs   mkfs.ext2     mkfs.ext3     mkfs.ext4     mkfs.ext4dev  mkfs.fat      mkfs.minix    mkfs.msdos    mkfs.ntfs     mkfs.vfat</div><div>root@zhanghang-virtual-machine:~# mkfs -t ext4 /dev/sda3</div><div>mke2fs 1.42.9 (4-Feb-2014)</div><div>Filesystem label=</div><div>OS type: Linux</div><div>Block size=4096 (log=2)</div><div>Fragment size=4096 (log=2)</div><div>Stride=0 blocks, Stripe width=0 blocks</div><div>131072 inodes, 524288 blocks</div><div>26214 blocks (5.00%) reserved for the super user</div><div>First data block=0</div><div>Maximum filesystem blocks=536870912</div><div>16 block groups</div><div>32768 blocks per group, 32768 fragments per group</div><div>8192 inodes per group</div><div>Superblock backups stored on blocks:</div><div>        32768, 98304, 163840, 229376, 294912</div><div><br/></div><div><br/></div><div>Allocating group tables: done</div><div>Writing inode tables: done</div><div>Creating journal (16384 blocks): done</div><div>Writing superblocks and filesystem accounting information: done</div><div><br/></div><div><br/></div><div>root@zhanghang-virtual-machine:~# mke2fs -j -L &quot;zhanghang&quot; -b 2048 -i 8192 /dev/sda3</div><div>mke2fs 1.42.9 (4-Feb-2014)</div><div>Filesystem label=zhanghang</div><div>OS type: Linux</div><div>Block size=2048 (log=1)</div><div>Fragment size=2048 (log=1)</div><div>Stride=0 blocks, Stripe width=0 blocks</div><div>262144 inodes, 1048576 blocks</div><div>52428 blocks (5.00%) reserved for the super user</div><div>First data block=0</div><div>Maximum filesystem blocks=537919488</div><div>64 block groups</div><div>16384 blocks per group, 16384 fragments per group</div><div>4096 inodes per group</div><div>Superblock backups stored on blocks:</div><div>        16384, 49152, 81920, 114688, 147456, 409600, 442368, 802816</div><div><br/></div><div><br/></div><div>Allocating group tables: done</div><div>Writing inode tables: done</div><div>Creating journal (32768 blocks): done</div><div>Writing superblocks and filesystem accounting information: done</div><div><br/></div><div><br/></div><div>root@zhanghang-virtual-machine:~# fsck -C -f -t /dev/sda3</div><div>fsck from util-linux 2.20.1</div><div>root@zhanghang-virtual-machine:~# fsck -C -f -t tex4 /dev/sda3</div><div>fsck from util-linux 2.20.1</div><div>e2fsck 1.42.9 (4-Feb-2014)</div><div>Pass 1: Checking inodes, blocks, and sizes</div><div>Pass 2: Checking directory structure</div><div>Pass 3: Checking directory connectivity</div><div>Pass 4: Checking reference counts</div><div>Pass 5: Checking group summary information</div><div>zhanghang: 11/262144 files (0.0% non-contiguous), 70365/1048576 blocks</div><div>root@zhanghang-virtual-machine:~# badblocks -sv /dev/sda3</div><div>Checking blocks 0 to 2097151</div><div>Checking for bad blocks (read-only test): done</div><div>Pass completed, 0 bad blocks found. (0/0/0 errors)</div><div><br/></div><div><br/></div><div>//在文件系统中最顶层有个lost+found目录，此目录会放置fsck检查文件系统后出现问题，有问题的数据会放置在此目录下</div></div><div><br/></div><div>磁盘挂载与卸载：</div><div>单一文件系统不应该被重复挂载在不同挂载点上</div><div>单一目录不应该重复挂载多个文件系统</div><div>作为挂载点的目录理应都是空目录</div><div>如果在挂载的目录下重新挂载另一个文件系统，原目录下的数据会暂时被覆盖，当新分区被卸载后，这些数据又将可以被看到</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@zhanghang-virtual-machine:~# mount -a</div><div>root@zhanghang-virtual-machine:~# cd /mnt/</div><div>root@zhanghang-virtual-machine:/mnt# ls</div><div>cdrom  hgfs</div><div>root@zhanghang-virtual-machine:/mnt# ls</div><div>cdrom  hgfs</div><div>root@zhanghang-virtual-machine:/mnt# ls</div><div>cdrom  hgfs</div><div>root@zhanghang-virtual-machine:/mnt# mkdir sda3</div><div>root@zhanghang-virtual-machine:/mnt# mount /dev/sda3 ./sda3/</div><div>root@zhanghang-virtual-machine:/mnt# df</div><div>Filesystem     1K-blocks    Used Available Use% Mounted on</div><div>udev             1006084       4   1006080   1% /dev</div><div>tmpfs             203920     664    203256   1% /run</div><div>/dev/sda1       39089600 6125520  30955404  17% /</div><div>none                   4       0         4   0% /sys/fs/cgroup</div><div>none                5120       0      5120   0% /run/lock</div><div>none             1019584     144   1019440   1% /run/shm</div><div>none              102400      36    102364   1% /run/user</div><div>/dev/sda3        1965788    9366   1851566   1% /mnt/sda3</div><div>root@zhanghang-virtual-machine:/mnt# ls</div><div>cdrom  hgfs  sda3</div><div>root@zhanghang-virtual-machine:/mnt# cd sda3/</div><div>root@zhanghang-virtual-machine:/mnt/sda3# ls</div><div>lost+found</div><div><br/></div><div><br/></div><div>root@zhanghang-virtual-machine:/mnt/sda3# mount -l</div><div>/dev/sda1 on / type ext4 (rw,errors=remount-ro)</div><div>proc on /proc type proc (rw,noexec,nosuid,nodev)</div><div>sysfs on /sys type sysfs (rw,noexec,nosuid,nodev)</div><div>none on /sys/fs/cgroup type tmpfs (rw)</div><div>none on /sys/fs/fuse/connections type fusectl (rw)</div><div>none on /sys/kernel/debug type debugfs (rw)</div><div>none on /sys/kernel/security type securityfs (rw)</div><div>udev on /dev type devtmpfs (rw,mode=0755)</div><div>devpts on /dev/pts type devpts (rw,noexec,nosuid,gid=5,mode=0620)</div><div>tmpfs on /run type tmpfs (rw,noexec,nosuid,size=10%,mode=0755)</div><div>none on /run/lock type tmpfs (rw,noexec,nosuid,nodev,size=5242880)</div><div>none on /run/shm type tmpfs (rw,nosuid,nodev)</div><div>none on /run/user type tmpfs (rw,noexec,nosuid,nodev,size=104857600,mode=0755)</div><div>none on /sys/fs/pstore type pstore (rw)</div><div>systemd on /sys/fs/cgroup/systemd type cgroup (rw,noexec,nosuid,nodev,none,name=systemd)</div><div>vmware-vmblock on /run/vmblock-fuse type fuse.vmware-vmblock (rw,nosuid,nodev,default_permissions,allow_other)</div><div>gvfsd-fuse on /run/user/112/gvfs type fuse.gvfsd-fuse (rw,nosuid,nodev,user=lightdm)</div><div>/dev/sda3 on /mnt/sda3 type ext3 (rw) [zhanghang]</div></div><div><br/></div><div><font style="font-size: 14pt;"><span style="font-size: 14pt; font-weight: bold;">卸载</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>root@zhanghang-virtual-machine:/mnt/sda3# umount /dev/sda3</div><div>umount: /mnt/sda3: device is busy.</div><div>        (In some cases useful info about processes that use</div><div>         the device is found by lsof(8) or fuser(1))</div><div>root@zhanghang-virtual-machine:/mnt/sda3# cd ../../</div><div>root@zhanghang-virtual-machine:/# umount /dev/sda3</div><div>root@zhanghang-virtual-machine:/# df</div><div>Filesystem     1K-blocks    Used Available Use% Mounted on</div><div>udev             1006084       4   1006080   1% /dev</div><div>tmpfs             203920     664    203256   1% /run</div><div>/dev/sda1       39089600 6125520  30955404  17% /</div><div>none                   4       0         4   0% /sys/fs/cgroup</div><div>none                5120       0      5120   0% /run/lock</div><div>none             1019584     144   1019440   1% /run/shm</div><div>none              102400      36    102364   1% /run/user</div></div><div><font style="font-size: 14pt;"><br/></font></div><div><font style="font-size: 9pt;"><span style="font-weight: bold;">使用Label name进行挂载</span></font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:/# dumpe2fs -h /dev/sda3 | grep name</font></div><div><font style="font-size: 9pt;">dumpe2fs 1.42.9 (4-Feb-2014)</font></div><div><font style="font-size: 9pt;">Filesystem volume name:   zhanghang</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:/# mount -L &quot;zhanghang&quot; /mnt/sda3/</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:/# df</font></div><div><font style="font-size: 9pt;">Filesystem     1K-blocks    Used Available Use% Mounted on</font></div><div><font style="font-size: 9pt;">udev             1006084       4   1006080   1% /dev</font></div><div><font style="font-size: 9pt;">tmpfs             203920     664    203256   1% /run</font></div><div><font style="font-size: 9pt;">/dev/sda1       39089600 6125520  30955404  17% /</font></div><div><font style="font-size: 9pt;">none                   4       0         4   0% /sys/fs/cgroup</font></div><div><font style="font-size: 9pt;">none                5120       0      5120   0% /run/lock</font></div><div><font style="font-size: 9pt;">none             1019584     144   1019440   1% /run/shm</font></div><div><font style="font-size: 9pt;">none              102400      36    102364   1% /run/user</font></div><div><font style="font-size: 9pt;">/dev/sda3        1965788    9366   1851566   1% /mnt/sda3</font></div></div><div><font style="font-size: 9pt;"><br/></font></div><div><span style="font-weight: bold;"><font style="font-size: 9pt;">开机挂载</font></span></div><div><span style="font-weight: bold;"><font style="font-size: 9pt;">/etc/fstab    /etc/mtab</font></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 9pt;"># /etc/fstab: static file system information.</font></div><div><font style="font-size: 9pt;">#</font></div><div><font style="font-size: 9pt;"># Use 'blkid' to print the universally unique identifier for a</font></div><div><font style="font-size: 9pt;"># device; this may be used with UUID= as a more robust way to name devices</font></div><div><font style="font-size: 9pt;"># that works even if disks are added and removed. See fstab(5).</font></div><div><font style="font-size: 9pt;">#</font></div><div><font style="font-size: 9pt;"># &lt;file system&gt; &lt;mount point&gt;   &lt;type&gt;  &lt;options&gt;       &lt;dump&gt;  &lt;pass&gt;</font></div><div><font style="font-size: 9pt;"># / was on /dev/sda1 during installation</font></div><div><font style="font-size: 9pt;">UUID=ce0666b7-882b-4ede-8e5f-3b8a2a4611dc /               ext4    errors=remount-ro 0       1</font></div><div><font style="font-size: 9pt;"># swap was on /dev/sda5 during installation</font></div><div><font style="font-size: 9pt;">UUID=ed808ec7-3fa6-47a3-bf78-5244d44be215 none            swap    sw              0       0</font></div><div><font style="font-size: 9pt;">/dev/fd0        /media/floppy0  auto    rw,user,noauto,exec,utf8 0       0</font></div><div><font style="font-size: 9pt;">/dev/sda3   /mnt/sda3   ext4    defaults    0   0</font></div></div><div><span style="color: unset; font-family: unset;"><font style="font-size: 9pt;">开机自动挂载脚本为/etc/fstab，实际挂载会记录到/etc/mtab和/proc/mounts中</font></span></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><span style="font-weight: bold; color: unset; font-family: unset;">特殊设备的挂载</span></font></div><div><font style="font-size: 9pt;">创建一个大文件：</font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 9pt;">dd if=/dev/zero of=/home/testfile bs=1M count=512</font></div><div><font style="font-size: 9pt;">if为input file输入文件为/dev/zero</font></div><div><font style="font-size: 9pt;">of为output file /home/testfile</font></div><div><font style="font-size: 9pt;">bs为每个block的大小</font></div><div><font style="font-size: 9pt;">count是指总共有几个bs</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:/home/zhanghang# dd if=/dev/zero of=/home/testfile bs=1M count=512</font></div><div><font style="font-size: 9pt;">512+0 records in</font></div><div><font style="font-size: 9pt;">512+0 records out</font></div><div><font style="font-size: 9pt;">536870912 bytes (537 MB) copied, 10.6491 s, 50.4 MB/s</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:/home/zhanghang# cd ../</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:/home# ls -la testfile</font></div><div><font style="font-size: 9pt;">-rw-r--r-- 1 root root 536870912  3æ 29 20:06 testfile</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:/home# ll -h testfile</font></div><div><font style="font-size: 9pt;">-rw-r--r-- 1 root root 512M  3æ 29 20:06 testfile</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><b><font style="font-size: 9pt;">//格式化</font></b></div><div>root@zhanghang-virtual-machine:/home# mkfs -t ext4 /home/testfile</div><div>mke2fs 1.42.9 (4-Feb-2014)</div><div>/home/testfile is not a block special device.</div><div>Proceed anyway? (y,n) y</div><div>Discarding device blocks: done</div><div>Filesystem label=</div><div>OS type: Linux</div><div>Block size=4096 (log=2)</div><div>Fragment size=4096 (log=2)</div><div>Stride=0 blocks, Stripe width=0 blocks</div><div>32768 inodes, 131072 blocks</div><div>6553 blocks (5.00%) reserved for the super user</div><div>First data block=0</div><div>Maximum filesystem blocks=134217728</div><div>4 block groups</div><div>32768 blocks per group, 32768 fragments per group</div><div>8192 inodes per group</div><div>Superblock backups stored on blocks:</div><div>        32768, 98304</div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>Allocating group tables: done</div><div>Writing inode tables: done</div><div>Creating journal (4096 blocks): done</div><div>Writing superblocks and filesystem accounting information: done</div><div><br/></div><div><b>//挂载</b></div><div>root@zhanghang-virtual-machine:/home# mkdir /media/cdrom</div><div>root@zhanghang-virtual-machine:/home# mount -o loop  /home/testfile /media/cdrom/</div><div>root@zhanghang-virtual-machine:/home# df</div><div>Filesystem     1K-blocks    Used Available Use% Mounted on</div><div>udev             1006084       4   1006080   1% /dev</div><div>tmpfs             203920     660    203260   1% /run</div><div>/dev/sda1       39089600 6143432  30937492  17% /</div><div>none                   4       0         4   0% /sys/fs/cgroup</div><div>none                5120       0      5120   0% /run/lock</div><div>none             1019584     144   1019440   1% /run/shm</div><div>none              102400      28    102372   1% /run/user</div><div>/dev/sda3        1965788    9366   1851566   1% /mnt/sda3</div><div>/dev/loop0        499656     396    462564   1% /media/cdrom</div></div><div><span style="font-size: 14pt;"><br/></span></div><div><span style="font-weight: bold;"><font style="font-size: 9pt;">构建swap分区：</font></span></div><div><font style="font-size: 9pt;">交换分区swap用来在物理内存不足时，为了后续程序的顺利运行，将内存中暂时不用的程序数据暂时放到硬盘的交换分区中。</font></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# fdisk /dev/sda</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Command (m for help): p</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Disk /dev/sda: 54.8 GB, 54760833024 bytes</font></div><div><font style="font-size: 9pt;">255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</font></div><div><font style="font-size: 9pt;">Units = sectors of 1 * 512 = 512 bytes</font></div><div><font style="font-size: 9pt;">Sector size (logical/physical): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">I/O size (minimum/optimal): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">Disk identifier: 0x0005c381</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">   Device Boot      Start         End      Blocks   Id  System</font></div><div><font style="font-size: 9pt;">/dev/sda1   *        2048    79693823    39845888   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda2        79695870    83884031     2094081    5  Extended</font></div><div><font style="font-size: 9pt;">/dev/sda3        83885000    88079303     2097152   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda5        79695872    83884031     2094080   82  Linux swap / Solaris</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Command (m for help): n</font></div><div><font style="font-size: 9pt;">Partition type:</font></div><div><font style="font-size: 9pt;">   p   primary (2 primary, 1 extended, 1 free)</font></div><div><font style="font-size: 9pt;">   l   logical (numbered from 5)</font></div><div><font style="font-size: 9pt;">Select (default p): p</font></div><div><font style="font-size: 9pt;">Selected partition 4</font></div><div><font style="font-size: 9pt;">First sector (79693824-106954751, default 79693824): 88888888</font></div><div><font style="font-size: 9pt;">Last sector, +sectors or +size{K,M,G} (88888888-106954751, default 106954751): +1024M</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Command (m for help): p</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Disk /dev/sda: 54.8 GB, 54760833024 bytes</font></div><div><font style="font-size: 9pt;">255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</font></div><div><font style="font-size: 9pt;">Units = sectors of 1 * 512 = 512 bytes</font></div><div><font style="font-size: 9pt;">Sector size (logical/physical): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">I/O size (minimum/optimal): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">Disk identifier: 0x0005c381</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">   Device Boot      Start         End      Blocks   Id  System</font></div><div><font style="font-size: 9pt;">/dev/sda1   *        2048    79693823    39845888   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda2        79695870    83884031     2094081    5  Extended</font></div><div><font style="font-size: 9pt;">/dev/sda3        83885000    88079303     2097152   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda4        88888888    90986039     1048576   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda5        79695872    83884031     2094080   82  Linux swap / Solaris</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Command (m for help): t</font></div><div><font style="font-size: 9pt;">Partition number (1-5): 4</font></div><div><font style="font-size: 9pt;">Hex code (type L to list codes): 82//改为交换分区的ID</font></div><div><font style="font-size: 9pt;">Changed system type of partition 4 to 82 (Linux swap / Solaris)</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Command (m for help): p</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Disk /dev/sda: 54.8 GB, 54760833024 bytes</font></div><div><font style="font-size: 9pt;">255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</font></div><div><font style="font-size: 9pt;">Units = sectors of 1 * 512 = 512 bytes</font></div><div><font style="font-size: 9pt;">Sector size (logical/physical): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">I/O size (minimum/optimal): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">Disk identifier: 0x0005c381</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">   Device Boot      Start         End      Blocks   Id  System</font></div><div><font style="font-size: 9pt;">/dev/sda1   *        2048    79693823    39845888   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda2        79695870    83884031     2094081    5  Extended</font></div><div><font style="font-size: 9pt;">/dev/sda3        83885000    88079303     2097152   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda4        88888888    90986039     1048576   82  Linux swap / Solaris</font></div><div><font style="font-size: 9pt;">/dev/sda5        79695872    83884031     2094080   82  Linux swap / Solaris</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Command (m for help): w</font></div><div><font style="font-size: 9pt;">The partition table has been altered!</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Calling ioctl() to re-read partition table.</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">WARNING: Re-reading the partition table failed with error 16: Device or resource busy.</font></div><div><font style="font-size: 9pt;">The kernel still uses the old table. The new table will be used at</font></div><div><font style="font-size: 9pt;">the next reboot or after you run partprobe(8) or kpartx(8)</font></div><div><font style="font-size: 9pt;">Syncing disks.</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# partprobe</font></div></div><div><font style="font-size: 9pt;"><br/></font></div><div><span style="font-weight: bold;"><font style="font-size: 9pt;">挂载swap分区</font></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# fdisk -l</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">Disk /dev/sda: 54.8 GB, 54760833024 bytes</font></div><div><font style="font-size: 9pt;">255 heads, 63 sectors/track, 6657 cylinders, total 106954752 sectors</font></div><div><font style="font-size: 9pt;">Units = sectors of 1 * 512 = 512 bytes</font></div><div><font style="font-size: 9pt;">Sector size (logical/physical): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">I/O size (minimum/optimal): 512 bytes / 512 bytes</font></div><div><font style="font-size: 9pt;">Disk identifier: 0x0005c381</font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;"><br/></font></div><div><font style="font-size: 9pt;">   Device Boot      Start         End      Blocks   Id  System</font></div><div><font style="font-size: 9pt;">/dev/sda1   *        2048    79693823    39845888   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda2        79695870    83884031     2094081    5  Extended</font></div><div><font style="font-size: 9pt;">/dev/sda3        83885000    88079303     2097152   83  Linux</font></div><div><font style="font-size: 9pt;">/dev/sda4        88888888    90986039     1048576   82  Linux swap / Solaris</font></div><div><font style="font-size: 9pt;">/dev/sda5        79695872    83884031     2094080   82  Linux swap / Solaris</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# mkswap /dev/sda4</font></div><div><font style="font-size: 9pt;">Setting up swapspace version 1, size = 1048572 KiB</font></div><div><font style="font-size: 9pt;">no label, UUID=201f2e20-6cc8-4bd9-89cf-6dbbc957dd4a</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# free</font></div><div><font style="font-size: 9pt;">             total       used       free     shared    buffers     cached</font></div><div><font style="font-size: 9pt;">Mem:       2039168     483644    1555524       4688      46676     238252</font></div><div><font style="font-size: 9pt;">-/+ buffers/cache:     198716    1840452</font></div><div><font style="font-size: 9pt;">Swap:      2094076          0    2094076</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# swapon /dev/sda4</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# free</font></div><div><font style="font-size: 9pt;">             total       used       free     shared    buffers     cached</font></div><div><font style="font-size: 9pt;">Mem:       2039168     483988    1555180       4688      46688     238276</font></div><div><font style="font-size: 9pt;">-/+ buffers/cache:     199024    1840144</font></div><div><font style="font-size: 9pt;">Swap:      3142648          0    3142648</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# swapon -s</font></div><div><font style="font-size: 9pt;">Filename                        Type            Size    Used    Priority</font></div><div><font style="font-size: 9pt;">/dev/sda5                               partition       2094076 0       -1</font></div><div><font style="font-size: 9pt;">/dev/sda4                               partition       1048572 0       -2</font></div></div><div><font style="font-size: 9pt;"><br/></font></div><div><span style="font-weight: bold;"><font style="font-size: 9pt;">使用loop设备构建swap分区</font></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# dd if=/dev/zero of=/tmp/swap bs=1M count=128</font></div><div><font style="font-size: 9pt;">128+0 records in</font></div><div><font style="font-size: 9pt;">128+0 records out</font></div><div><font style="font-size: 9pt;">134217728 bytes (134 MB) copied, 0.452258 s, 297 MB/s</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# ll -h /tmp/swap</font></div><div><font style="font-size: 9pt;">-rw-r--r-- 1 root root 128M  3æ 29 20:29 /tmp/swap</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~#</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# mkswap /tmp/swap</font></div><div><font style="font-size: 9pt;">Setting up swapspace version 1, size = 131068 KiB</font></div><div><font style="font-size: 9pt;">no label, UUID=ed5b194a-2407-47dc-b75a-691d30948c1b</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# free</font></div><div><font style="font-size: 9pt;">             total       used       free     shared    buffers     cached</font></div><div><font style="font-size: 9pt;">Mem:       2039168     618544    1420624       4688      46728     369356</font></div><div><font style="font-size: 9pt;">-/+ buffers/cache:     202460    1836708</font></div><div><font style="font-size: 9pt;">Swap:      3142648          0    3142648</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# swapon /tmp/swap</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# free</font></div><div><font style="font-size: 9pt;">             total       used       free     shared    buffers     cached</font></div><div><font style="font-size: 9pt;">Mem:       2039168     618772    1420396       4688      46728     369356</font></div><div><font style="font-size: 9pt;">-/+ buffers/cache:     202688    1836480</font></div><div><font style="font-size: 9pt;">Swap:      3273716          0    3273716</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# swapon -s</font></div><div><font style="font-size: 9pt;">Filename                        Type            Size    Used    Priority</font></div><div><font style="font-size: 9pt;">/dev/sda5                               partition       2094076 0       -1</font></div><div><font style="font-size: 9pt;">/dev/sda4                               partition       1048572 0       -2</font></div><div><font style="font-size: 9pt;">/tmp/swap                               file            131068  0       -3</font></div></div><div><font style="font-size: 9pt;"><br/></font></div><div><span style="font-weight: bold;"><font style="font-size: 9pt;">卸载swap分区</font></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# swapoff /dev/sda4</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# swapoff /tmp/swap</font></div><div><font style="font-size: 9pt;">root@zhanghang-virtual-machine:~# free</font></div><div><font style="font-size: 9pt;">             total       used       free     shared    buffers     cached</font></div><div><font style="font-size: 9pt;">Mem:       2039168     618332    1420836       4688      46736     369356</font></div><div><font style="font-size: 9pt;">-/+ buffers/cache:     202240    1836928</font></div><div><font style="font-size: 9pt;">Swap:      2094076          0    2094076</font></div></div><div><font style="font-size: 14pt;"><br/></font></div><div><span style="font-size: 10pt;">单一磁盘大小超过2T时可以使用parted命令进行分区</span></div></span>
</div></body></html> 